2025-07-12 03:00:01,639 - ForwardPassTester - INFO - ============================================================
2025-07-12 03:00:01,639 - ForwardPassTester - INFO - FORWARD PASS TESTER INITIALIZED
2025-07-12 03:00:01,639 - ForwardPassTester - INFO - ============================================================
2025-07-12 03:00:01,639 - ForwardPassTester - INFO - ðŸŽ¯ Starting comprehensive forward pass test (batch_size=4)...
2025-07-12 03:00:01,639 - ForwardPassTester - INFO - ðŸ”„ Preparing SMALL test data (batch_size=4)...
2025-07-12 03:00:02,257 - ForwardPassTester - INFO - âœ… DataProcessor initialized successfully
2025-07-12 03:00:02,257 - ForwardPassTester - INFO - ðŸ“ Processing text input...
2025-07-12 03:00:02,526 - ForwardPassTester - INFO - âœ… Full dataset text processing complete:
2025-07-12 03:00:02,526 - ForwardPassTester - INFO -    - Full Input IDs shape: torch.Size([2000, 150])
2025-07-12 03:00:02,526 - ForwardPassTester - INFO -    - Full Attention mask shape: torch.Size([2000, 150])
2025-07-12 03:00:02,526 - ForwardPassTester - INFO - ðŸ”¢ Processing numerical features...
2025-07-12 03:00:24,922 - ForwardPassTester - INFO - âœ… Full dataset numerical processing complete:
2025-07-12 03:00:24,922 - ForwardPassTester - INFO -    - Full Numerical features shape: torch.Size([2000, 16])
2025-07-12 03:00:24,922 - ForwardPassTester - INFO - âœ‚ï¸ Extracting small test subset (4 samples)...
2025-07-12 03:00:24,923 - ForwardPassTester - INFO - âœ… Small test data prepared:
2025-07-12 03:00:24,923 - ForwardPassTester - INFO -    - Test Input IDs shape: torch.Size([4, 150])
2025-07-12 03:00:24,923 - ForwardPassTester - INFO -    - Test Attention mask shape: torch.Size([4, 150])
2025-07-12 03:00:24,923 - ForwardPassTester - INFO -    - Test Numerical features shape: torch.Size([4, 16])
2025-07-12 03:00:24,923 - ForwardPassTester - INFO -    - Memory reduction: 2000 â†’ 4 samples
2025-07-12 03:00:24,923 - ForwardPassTester - INFO - ðŸ“Š Sample test data:
2025-07-12 03:00:24,925 - ForwardPassTester - INFO -    - First input_ids sample: tensor([   27,    31,    51,  1829, 18940,    11,   897,   924, 12643,     6])...
2025-07-12 03:00:24,930 - ForwardPassTester - INFO -    - First numerical features: tensor([ 4.3000e+01, -2.5191e-02, -3.5704e-02,  1.0000e+01,  5.0000e+00,
         8.0000e+00,  5.0000e+00, -2.4814e-02, -2.1248e-02,  4.1378e-02,
         1.1000e+01,  9.0000e+00, -2.4896e-03,  7.0000e+00, -8.3114e-03,
         6.6000e+01])
2025-07-12 03:00:24,930 - ForwardPassTester - INFO - ðŸ¤– Initializing model...
2025-07-12 03:00:48,236 - ForwardPassTester - INFO - âœ… Model initialized successfully
2025-07-12 03:00:48,238 - ForwardPassTester - INFO - ðŸ“ˆ Model information:
2025-07-12 03:00:48,238 - ForwardPassTester - INFO -    - Total parameters: 248,893,184
2025-07-12 03:00:48,238 - ForwardPassTester - INFO -    - Trainable parameters: 248,893,184
2025-07-12 03:00:48,238 - ForwardPassTester - INFO - ðŸš€ Testing forward pass with 4 samples...
2025-07-12 03:00:48,238 - ForwardPassTester - INFO - âš¡ Starting forward pass execution with batch size 4...
2025-07-12 03:00:48,238 - ForwardPassTester - INFO -    - Input tensor shapes: torch.Size([4, 150]), torch.Size([4, 150]), torch.Size([4, 16])
2025-07-12 03:00:49,075 - ForwardPassTester - ERROR - âŒ Error in forward pass: The expanded size of the tensor (768) must match the existing size (32128) at non-singleton dimension 2.  Target sizes: [4, 150, 768].  Tensor sizes: [4, 1, 32128]
2025-07-12 03:00:49,075 - ForwardPassTester - ERROR - âŒ Error type: RuntimeError
2025-07-12 03:00:49,075 - ForwardPassTester - ERROR - âŒ Traceback: Traceback (most recent call last):
  File "/Users/jaceysimpson/Vscode/Alita/test_forward_pass.py", line 164, in test_forward_pass
    output = self.model.forward(
  File "/Users/jaceysimpson/Vscode/Alita/src/model_setup.py", line 53, in forward
    combined_output = combined_output.unsqueeze(1).expand(batch_size, seq_length, hidden_layer_size) # should look like [text_output(eg. [0.124, 0.481, 0.601]), numerical_output(eg. [0.567, 0.678, ...]) --> [0.124, 0.481, 0.601, 0.567, 0.678, ...]
RuntimeError: The expanded size of the tensor (768) must match the existing size (32128) at non-singleton dimension 2.  Target sizes: [4, 150, 768].  Tensor sizes: [4, 1, 32128]

2025-07-12 03:00:49,075 - ForwardPassTester - ERROR - ðŸ’¥ TEST FAILED: The expanded size of the tensor (768) must match the existing size (32128) at non-singleton dimension 2.  Target sizes: [4, 150, 768].  Tensor sizes: [4, 1, 32128]
2025-07-12 03:00:49,075 - ForwardPassTester - INFO - ============================================================
2025-07-12 03:00:49,075 - ForwardPassTester - INFO - TEST SESSION ENDED
2025-07-12 03:00:49,075 - ForwardPassTester - INFO - ============================================================
